schemaVersion: 2.2.0
metadata:
  name: node-postgres-workspace
  version: 1.0.0
components:
  - name: node
    container:
      image: 'docker pull mcr.microsoft.com/devcontainers/typescript-node:dev-22-bookworm'
      memoryLimit: 1Gi
      mountSources: true
      command:
        - sleep
      args:
        - infinity
      endpoints:
        - name: http
          targetPort: 8080
          exposure: public
        - name: http2
          targetPort: 3000
          exposure: public
      env:
        - name: DATABASE_URL
          value: jdbc:postgresql://postgresql:5432/mydb
        - name: DB_USER
          value: myuser
        - name: DB_PASSWORD
          value: mypassword

  - name: postgresql
    container:
      image: bitnami/postgresql:17
      memoryLimit: 512Mi
      env:
        - name: POSTGRESQL_USERNAME
          value: myuser
        - name: POSTGRESQL_PASSWORD
          value: mypassword
        - name: POSTGRESQL_DATABASE
          value: mydb
